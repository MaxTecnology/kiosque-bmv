import{a as Le,c as De,d as fe}from"./chunk-MGIMVFL5.js";import{a as M}from"./chunk-53UE6C6K.js";import{a as ye}from"./chunk-O7WP6NWV.js";import{a as be}from"./chunk-2TO534EY.js";import"./chunk-RSPORLB7.js";import{$,Aa as ae,Cb as ve,Fb as F,G as t,H as E,J as Q,K as h,Kb as Ee,Lb as ce,M as o,O as r,Oa as _,P as i,Pa as le,Q as u,Sa as Y,T as U,U as g,Ua as oe,V as j,Va as de,Wa as pe,Xa as se,Ya as me,Z as K,_ as Z,aa as X,ba as l,ca as s,d as z,da as L,e as P,ec as Se,fa as J,ga as ee,gc as T,h as W,ha as te,jc as H,kb as C,la as B,lb as O,lc as w,ma as d,na as p,nb as A,ob as ue,p as R,s as y,t as I,ta as ie,tc as ge,ua as ne,va as re,x as f,y as b}from"./chunk-K77LY3FL.js";import"./chunk-B4AJQJMI.js";var Ie=(()=>{class a{static{this.\u0275fac=function(m){return new(m||a)}}static{this.\u0275cmp=y({type:a,selectors:[["orders"]],decls:1,vars:0,template:function(m,e){m&1&&u(0,"router-outlet")},dependencies:[le],encapsulation:2})}}return a})();var he=(()=>{class a extends be{constructor(n,m,e){super(m),this.client=n,this.coreService=m,this.route=e,this.columns=[{key:"id",translation_key:"ORDER.FIELDS.ID.LABEL",column:{title:"",type:"string"}},{key:"user",translation_key:"ORDER.FIELDS.USER.LABEL",column:{title:"",type:"string",valuePrepareFunction:v=>v?.mobile_number}},{key:"vendor",translation_key:"ORDER.FIELDS.VENDOR.LABEL",column:{title:"",type:"string",valuePrepareFunction:v=>v.name}},{key:"order_type",translation_key:"ORDER.FIELDS.ORDER_TYPE.LABEL",column:{title:"",type:"string"}},{key:"status",translation_key:"ORDER.FIELDS.STATUS.LABEL",column:{title:"",type:"string"}},{key:"total",translation_key:"ORDER.FIELDS.TOTAL.LABEL",column:{title:"",type:"string",filter:!1}}],this.editPageUrl="pages/orders/edit"}ngOnInit(){super.ngOnInit(this.client.getBaseEndpoint())}static{this.\u0275fac=function(m){return new(m||a)(E(M),E(w),E(_))}}static{this.\u0275cmp=y({type:a,selectors:[["list"]],features:[Q],decls:6,vars:6,consts:[["nbSpinnerStatus","danger",3,"nbSpinner"],[3,"delete","edit","settings","source"]],template:function(m,e){m&1&&(r(0,"nb-card")(1,"nb-card-header"),l(2),d(3,"translate"),i(),r(4,"nb-card-body",0)(5,"angular2-smart-table",1),g("delete",function(c){return e.onDeleteConfirm(c)})("edit",function(c){return e.edit(c)}),i()()()),m&2&&(t(2),L(" ",p(3,4,"ORDER.LABELS.LIST")," "),t(2),o("nbSpinner",e.loading),t(),o("settings",e.settings)("source",e.source))},dependencies:[F,A,O,C,Se,T],styles:[`[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{transform:translateZ(0)}





`]})}}return a})();var x=class{};var V=class{};var k=class{};var Fe=["googleMap"],q=(a,S)=>({lat:a,lng:S});function Me(a,S){if(a&1){let n=U();r(0,"div",3)(1,"div",4)(2,"google-map",16,2),g("boundsChanged",function(){f(n);let e=j();return b(e.onBoundsChanged())}),u(4,"map-marker",17)(5,"map-marker",18)(6,"map-marker",19),i()()()}if(a&2){let n=j();t(4),o("position",B(3,q,n.parseFloat(n.order==null||n.order.address==null?null:n.order.address.latitude),n.parseFloat(n.order==null||n.order.address==null?null:n.order.address.longitude))),t(),o("position",B(6,q,n.parseFloat(n.order==null||n.order.vendor==null?null:n.order.vendor.latitude),n.parseFloat(n.order==null||n.order.vendor==null?null:n.order.vendor.longitude))),t(),o("position",B(9,q,n.parseFloat(n.order==null||n.order.delivery==null||n.order.delivery.delivery==null?null:n.order.delivery.delivery.latitude),n.parseFloat(n.order==null||n.order.delivery==null||n.order.delivery.delivery==null?null:n.order.delivery.delivery.longitude)))}}function Te(a,S){if(a&1&&(r(0,"nb-option",20),l(1),i()),a&2){let n=S.$implicit;o("value",n),t(),L("",n," ")}}function we(a,S){if(a&1&&(r(0,"label",21),l(1),i()),a&2){let n=S.$implicit;t(),s(n)}}var G=(()=>{class a{constructor(n,m,e,v,c){this.client=n,this.coreService=m,this.route=e,this.categoryClient=v,this.order=new x,this.orderRequest=new V,this.orderError=new k,this.showProgress=!1,this.showProgressButton=!1,this.categories=[],this.orderStatusList=["new","pending","cancelled","rejected","refund","hold","failed","accepted","preparing","prepared","dispatched","intransit","complete"],this.editId=null;let D=m.appConfigService.getConfig().mapsApiKey;this.apiLoaded=c.jsonp("https://maps.googleapis.com/maps/api/js?key="+D,"callback").pipe(P(()=>!0),W(()=>z(!1)))}ngOnInit(){this.getEditData()}getEditData(){let n=this.route.snapshot.paramMap.get("id");n&&(this.editId=n,this.getDataById(n).subscribe())}getDataById(n){return this.showProgress=!0,this.client.show(n).pipe(P(m=>(this.showProgress=!1,this.order=m,this.orderRequest.status=this.order.status,this.setMapBounds(),m)))}saveOrder(){this.showProgressButton=!0;let n=new FormData;n.append("status",this.orderRequest.status),(this.editId?this.client.update(this.editId,n):this.client.store(n)).subscribe(e=>{this.showProgressButton=!1,this.coreService.toastService.showToast(H.SUCCESS,"Saved","Saved successfully!"),this.back()},e=>{if(this.showProgressButton=!1,this.coreService.toastService.showToast(H.DANGER,"Failed",e.error.message),e.error.errors){let v=e.error.errors;this.orderError.status=v?.status}})}back(){this.coreService.location.back()}parseFloat(n){return parseFloat(n)}setMapBounds(){let n=new google.maps.LatLngBounds;n.extend(new google.maps.LatLng(parseFloat(this.order.address.latitude),parseFloat(this.order.address.longitude))),n.extend(new google.maps.LatLng(parseFloat(this.order.vendor.latitude),parseFloat(this.order.vendor.longitude))),this.order.delivery?.delivery?.latitude&&n.extend(new google.maps.LatLng(parseFloat(this.order.delivery?.delivery?.latitude),parseFloat(this.order.delivery?.delivery?.longitude))),this.googleMap.fitBounds(n)}onBoundsChanged(){this.googleMap.getZoom()>13&&(this.googleMap.zoom=13)}static{this.\u0275fac=function(m){return new(m||a)(E(M),E(w),E(_),E(ye),E(ae))}}static{this.\u0275cmp=y({type:a,selectors:[["save"]],viewQuery:function(m,e){if(m&1&&K(Fe,5),m&2){let v;Z(v=$())&&(e.googleMap=v.first)}},decls:203,vars:129,consts:[["form","ngForm"],["status","ngModel"],["googleMap",""],[1,"row"],[1,"col-md-12"],["nbSpinnerStatus","danger",3,"nbSpinner"],[3,"ngSubmit"],["class","row",4,"ngIf"],[1,"form-group"],["readonly","","nbInput","","fullWidth","",3,"value"],[1,"col-md-6"],["fullWidth","","name","status","id","status",2,"text-transform","capitalize",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","error text-danger",4,"ngFor","ngForOf"],["type","submit","nbButton","","status","success","size","medium","nbSpinnerStatus","success","nbSpinnerSize","small",3,"disabled","nbSpinner"],["type","button","nbButton","","status","danger","size","medium",3,"click"],["width","100%","minZoom","1",3,"boundsChanged"],["label","C",3,"position"],["label","V",3,"position"],["label","D",3,"position"],[3,"value"],[1,"error","text-danger"]],template:function(m,e){if(m&1){let v=U();r(0,"div",3)(1,"div",4)(2,"nb-card")(3,"nb-card-body",5)(4,"form",6,0),g("ngSubmit",function(){return f(v),b(e.saveOrder())}),h(6,Me,7,12,"div",7),d(7,"async"),r(8,"div",3)(9,"div",4)(10,"nb-card")(11,"nb-card-header"),l(12),d(13,"translate"),i(),r(14,"nb-card-body")(15,"div",8)(16,"label"),l(17),d(18,"translate"),i(),u(19,"input",9),i(),r(20,"div",3)(21,"div",10)(22,"div",8)(23,"label"),l(24),d(25,"translate"),i(),u(26,"input",9),i()(),r(27,"div",10)(28,"div",8)(29,"label"),l(30),d(31,"translate"),i(),u(32,"input",9),i()()()()()()(),r(33,"div",3)(34,"div",4)(35,"nb-card")(36,"nb-card-header"),l(37),d(38,"translate"),i(),r(39,"nb-card-body")(40,"div",8)(41,"label"),l(42),d(43,"translate"),i(),u(44,"input",9),i(),r(45,"div",8)(46,"label"),l(47),d(48,"translate"),i(),u(49,"input",9),i(),r(50,"div",3)(51,"div",10)(52,"div",8)(53,"label"),l(54),d(55,"translate"),i(),u(56,"input",9),i()(),r(57,"div",10)(58,"div",8)(59,"label"),l(60),d(61,"translate"),i(),u(62,"input",9),i()()()()()()(),r(63,"div",3)(64,"div",4)(65,"nb-card")(66,"nb-card-header"),l(67),d(68,"translate"),i(),r(69,"nb-card-body")(70,"div",3)(71,"div",4)(72,"div",8)(73,"label"),l(74),d(75,"translate"),i(),u(76,"input",9),i(),r(77,"div",3)(78,"div",10)(79,"div",8)(80,"label"),l(81),d(82,"translate"),i(),u(83,"input",9),i()(),r(84,"div",10)(85,"div",8)(86,"label"),l(87),d(88,"translate"),i(),u(89,"input",9),i()()()()()()()()(),r(90,"div",3)(91,"div",4)(92,"nb-card")(93,"nb-card-header"),l(94),d(95,"translate"),i(),r(96,"nb-card-body")(97,"div",3)(98,"div",4)(99,"div",8)(100,"label"),l(101),d(102,"translate"),i(),u(103,"input",9),i(),r(104,"div",3)(105,"div",10)(106,"div",8)(107,"label"),l(108),d(109,"translate"),i(),u(110,"input",9),i()(),r(111,"div",10)(112,"div",8)(113,"label"),l(114),d(115,"translate"),i(),u(116,"input",9),i()()(),r(117,"div",3)(118,"div",10)(119,"div",8)(120,"label"),l(121),d(122,"translate"),i(),u(123,"input",9),i()(),r(124,"div",10)(125,"div",8)(126,"label"),l(127),d(128,"translate"),i(),u(129,"input",9),i()()()()()()()()(),r(130,"div",3)(131,"div",4)(132,"nb-card")(133,"nb-card-header"),l(134),d(135,"translate"),i(),r(136,"nb-card-body")(137,"div",3)(138,"div",10)(139,"div",8)(140,"label"),l(141),d(142,"translate"),i(),u(143,"input",9),i()(),r(144,"div",10)(145,"div",8)(146,"label"),l(147),d(148,"translate"),i(),u(149,"input",9),i()()(),r(150,"div",3)(151,"div",10)(152,"div",8)(153,"label"),l(154),d(155,"translate"),i(),u(156,"input",9),i()(),r(157,"div",10)(158,"div",8)(159,"label"),l(160),d(161,"translate"),i(),u(162,"input",9),i()()(),r(163,"div",8)(164,"label"),l(165),d(166,"translate"),i(),u(167,"input",9),i(),r(168,"div",8)(169,"label"),l(170),d(171,"translate"),i(),u(172,"input",9),i(),r(173,"div",8)(174,"label"),l(175),d(176,"translate"),i(),u(177,"input",9),i()()()()(),r(178,"div",8)(179,"label"),l(180),d(181,"translate"),i(),u(182,"input",9),i(),r(183,"div",8)(184,"label"),l(185),d(186,"translate"),i(),u(187,"input",9),i(),r(188,"div",8)(189,"label"),l(190),d(191,"translate"),i(),r(192,"nb-select",11,1),te("ngModelChange",function(D){return f(v),ee(e.orderRequest.status,D)||(e.orderRequest.status=D),b(D)}),h(194,Te,2,2,"nb-option",12),i(),h(195,we,2,1,"label",13),i(),r(196,"button",14),l(197),d(198,"translate"),i(),l(199," \xA0 "),r(200,"button",15),g("click",function(){return f(v),b(e.back())}),l(201),d(202,"translate"),i()()()()()()}if(m&2){let v=X(5);t(3),o("nbSpinner",e.showProgress),t(3),o("ngIf",p(7,63,e.apiLoaded)),t(6),s(p(13,65,"ORDER.FIELDS.USER.HEADER")),t(5),s(p(18,67,"ORDER.FIELDS.USER.MOBILE_NUMBER.LABEL")),t(2),o("value",e.order.user==null?null:e.order.user.mobile_number),t(5),s(p(25,69,"ORDER.FIELDS.USER.EMAIL.LABEL")),t(2),o("value",e.order.user==null?null:e.order.user.email),t(4),s(p(31,71,"ORDER.FIELDS.USER.NAME.LABEL")),t(2),o("value",e.order.user==null?null:e.order.user.name),t(5),s(p(38,73,"ORDER.FIELDS.VENDOR.HEADER")),t(5),s(p(43,75,"ORDER.FIELDS.VENDOR.NAME.LABEL")),t(2),o("value",e.order.vendor==null?null:e.order.vendor.name),t(3),s(p(48,77,"ORDER.FIELDS.VENDOR.ADDRESS.LABEL")),t(2),o("value",e.order.vendor==null?null:e.order.vendor.address),t(5),s(p(55,79,"ORDER.FIELDS.VENDOR.LATITUDE.LABEL")),t(2),o("value",e.order.vendor==null?null:e.order.vendor.latitude),t(4),s(p(61,81,"ORDER.FIELDS.VENDOR.LONGITUDE.LABEL")),t(2),o("value",e.order.vendor==null?null:e.order.vendor.longitude),t(5),s(p(68,83,"ORDER.FIELDS.ADDRESS.HEADER")),t(7),s(p(75,85,"ORDER.FIELDS.ADDRESS.FORMATTED_ADDRESS.LABEL")),t(2),o("value",e.order.address==null?null:e.order.address.formatted_address),t(5),s(p(82,87,"ORDER.FIELDS.ADDRESS.LATITUDE.LABEL")),t(2),o("value",e.order.address==null?null:e.order.address.latitude),t(4),s(p(88,89,"ORDER.FIELDS.ADDRESS.LONGITUDE.LABEL")),t(2),o("value",e.order.address==null?null:e.order.address.longitude),t(5),s(p(95,91,"ORDER.FIELDS.DELIVERY.HEADER")),t(7),s(p(102,93,"ORDER.FIELDS.DELIVERY.STATUS.LABEL")),t(2),o("value",e.order.delivery==null?null:e.order.delivery.status),t(5),s(p(109,95,"ORDER.FIELDS.DELIVERY.NAME.LABEL")),t(2),o("value",e.order.delivery==null||e.order.delivery.delivery==null||e.order.delivery.delivery.user==null?null:e.order.delivery.delivery.user.name),t(4),s(p(115,97,"ORDER.FIELDS.DELIVERY.MOBILE_NUMBER.LABEL")),t(2),o("value",e.order.delivery==null||e.order.delivery.delivery==null||e.order.delivery.delivery.user==null?null:e.order.delivery.delivery.user.mobile_number),t(5),s(p(122,99,"ORDER.FIELDS.DELIVERY.LATITUDE.LABEL")),t(2),o("value",e.order.delivery==null||e.order.delivery.delivery==null?null:e.order.delivery.delivery.latitude),t(4),s(p(128,101,"ORDER.FIELDS.DELIVERY.LONGITUDE.LABEL")),t(2),o("value",e.order.delivery==null||e.order.delivery.delivery==null?null:e.order.delivery.delivery.longitude),t(5),s(p(135,103,"ORDER.FIELDS.PAYMENT.HEADER")),t(7),s(p(142,105,"ORDER.FIELDS.SUBTOTAL.LABEL")),t(2),o("value",e.order.subtotal),t(4),s(p(148,107,"ORDER.FIELDS.TAXES.LABEL")),t(2),o("value",e.order.taxes),t(5),s(p(155,109,"ORDER.FIELDS.DELIVERY_FEE.LABEL")),t(2),o("value",e.order.delivery_fee),t(4),s(p(161,111,"ORDER.FIELDS.DISCOUNT.LABEL")),t(2),o("value",e.order.discount),t(3),s(p(166,113,"ORDER.FIELDS.TOTAL.LABEL")),t(2),o("value",e.order.total),t(3),s(p(171,115,"ORDER.FIELDS.PAYMENT_METHOD.LABEL")),t(2),o("value",e.order.payment==null||e.order.payment.payment_method==null?null:e.order.payment.payment_method.title),t(3),s(p(176,117,"ORDER.FIELDS.PAYMENT_STATUS.LABEL")),t(2),o("value",e.order.payment==null?null:e.order.payment.status),t(3),s(p(181,119,"ORDER.FIELDS.TYPE.LABEL")),t(2),o("value",e.order.type),t(3),s(p(186,121,"ORDER.FIELDS.CREATED_AT.LABEL")),t(2),o("value",e.order.created_at),t(3),s(p(191,123,"ORDER.FIELDS.STATUS.LABEL")),t(2),J("ngModel",e.orderRequest.status),t(2),o("ngForOf",e.orderStatusList),t(),o("ngForOf",e.orderError.status),t(),o("disabled",!v.form.valid||e.showProgressButton)("nbSpinner",e.showProgressButton),t(),L(" ",p(198,125,"COMMON.SAVE")," "),t(4),L(" ",p(202,127,"COMMON.BACK")," ")}},dependencies:[ie,ne,me,oe,de,se,pe,ue,ce,Ee,F,A,O,C,ve,Le,De,re,T],encapsulation:2})}}return a})();var Ne=[{path:"",component:Ie,children:[{path:"add",component:G},{path:"list",component:he},{path:"edit/:id",component:G}]}],Be=(()=>{class a{static{this.\u0275fac=function(m){return new(m||a)}}static{this.\u0275mod=I({type:a})}static{this.\u0275inj=R({imports:[Y.forChild(Ne),Y]})}}return a})();var st=(()=>{class a{static{this.\u0275fac=function(m){return new(m||a)}}static{this.\u0275mod=I({type:a})}static{this.\u0275inj=R({imports:[ge,Be,fe]})}}return a})();export{st as OrdersModule};
