import{a as x}from"./chunk-5YRDOJWB.js";import{a as fe}from"./chunk-2TO534EY.js";import"./chunk-RSPORLB7.js";import{Cb as de,Fb as T,G as i,H as v,J as Z,K as S,Kb as ue,Lb as ce,M as p,O as a,Oa as q,P as r,Pa as $,Q as J,Sa as k,T as Q,Ta as ee,U as w,Ua as te,V as X,Va as ie,Wa as ne,Xa as re,Ya as ae,Za as oe,aa as E,ba as s,ca as u,cb as se,da as _,e as P,ec as ge,fa as C,ga as R,gc as V,ha as y,jc as M,kb as le,lb as A,lc as O,ma as m,na as d,nb as N,ob as pe,p as B,s as I,t as L,ta as Y,tc as he,x as f,xb as me,y as b}from"./chunk-K77LY3FL.js";import"./chunk-B4AJQJMI.js";var _e=(()=>{class n{static{this.\u0275fac=function(l){return new(l||n)}}static{this.\u0275cmp=I({type:n,selectors:[["users"]],decls:1,vars:0,template:function(l,e){l&1&&J(0,"router-outlet")},dependencies:[$],encapsulation:2})}}return n})();var Se=(()=>{class n extends fe{constructor(t,l,e){super(l),this.client=t,this.coreService=l,this.route=e,this.columns=[{key:"name",translation_key:"USER.NAME.LABEL",column:{title:"",type:"string"}},{key:"email",translation_key:"USER.EMAIL.LABEL",column:{title:"",type:"string"}}],this.editPageUrl="pages/users/edit",this.actionSettings={actions:{columnTitle:"Action",position:"right",add:!1}}}ngOnInit(){super.ngOnInit(this.client.getBaseEndpoint())}delete(t){if(t.data.id===1){this.coreService.toastService.showToast(M.DANGER,"Failed","Cannot delete administrator"),this.loading=!1;return}super.delete(t)}static{this.\u0275fac=function(l){return new(l||n)(v(x),v(O),v(q))}}static{this.\u0275cmp=I({type:n,selectors:[["list"]],features:[Z],decls:6,vars:6,consts:[["nbSpinnerStatus","danger",3,"nbSpinner"],[3,"delete","edit","settings","source"]],template:function(l,e){l&1&&(a(0,"nb-card")(1,"nb-card-header"),s(2),m(3,"translate"),r(),a(4,"nb-card-body",0)(5,"angular2-smart-table",1),w("delete",function(h){return e.onDeleteConfirm(h)})("edit",function(h){return e.edit(h)}),r()()()),l&2&&(i(2),_(" ",d(3,4,"USER.LABELS.LIST")," "),i(2),p("nbSpinner",e.loading),i(),p("settings",e.settings)("source",e.source))},dependencies:[T,N,A,le,ge,V],styles:[`[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{transform:translateZ(0)}





`]})}}return n})();var W=class{};var D=class{constructor(){this.mobile_verified=!1,this.balance=0}};var F=class{};function we(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function Ie(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function Me(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function Be(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function Le(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function qe(n,c){if(n&1&&(a(0,"nb-option",28),s(1),r()),n&2){let t=c.$implicit,l=X();p("value",t.name),i(),u(l.formatRole(t.name))}}function Ae(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function Ne(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function Te(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}function xe(n,c){if(n&1&&(a(0,"label",27),s(1),r()),n&2){let t=c.$implicit;i(),u(t)}}var j=(()=>{class n{constructor(t,l,e){this.client=t,this.coreService=l,this.route=e,this.user=new W,this.userRoles=[],this.userRequest=new D,this.userError=new F,this.showProgress=!1,this.showProgressButton=!1,this.isEdit=!1,this.editId=null}ngOnInit(){this.getRoles().subscribe(),this.getEditData()}getRoles(){return this.client.roles().pipe(P(t=>(this.userRoles=t,t)))}getEditData(){let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.editId=t,this.getDataById(t).subscribe())}getDataById(t){return this.showProgress=!0,this.client.show(t).pipe(P(l=>{this.showProgress=!1,this.user=l,this.userRequest.name=this.user.name,this.userRequest.email=this.user.email,this.userRequest.mobile_number=this.user.mobile_number,this.userRequest.roles=[],this.userRequest.balance=this.user.wallet.balance;let e=[];for(let g=0;g<this.user.roles.length;g++)e.push(this.user.roles[g].name);return this.userRequest.roles=e,this.userRequest.language=this.user.language,this.userRequest.mobile_verified=this.user.mobile_verified,l}))}saveUser(){this.showProgressButton=!0;let t=new FormData;t.append("name",this.userRequest.name),t.append("email",this.userRequest.email),t.append("mobile_number",this.userRequest.mobile_number),this.userRequest.password&&t.append("password",this.userRequest.password),t.append("mobile_verified",this.userRequest.mobile_verified?"1":"0"),t.append("language",this.userRequest.language),t.append("balance",String(this.userRequest.balance));for(let e=0;e<this.userRequest.roles.length;e++)t.append("roles[]",this.userRequest.roles[e]);this.userRequest.image&&t.append("image",this.userRequest.image),(this.isEdit?this.client.update(this.editId,t):this.client.store(t)).subscribe(e=>{this.showProgressButton=!1,this.coreService.toastService.showToast(M.SUCCESS,"Saved","Saved successfully!"),this.back()},e=>{this.showProgressButton=!1,this.coreService.toastService.showToast(M.DANGER,"Failed",e.error.message),e.error.errors&&(e.error.errors.name&&(this.userError.name=e.error.errors.name),e.error.errors.image&&(this.userError.image=e.error.errors.image),e.error.errors.email&&(this.userError.email=e.error.errors.email),e.error.errors.mobile_number&&(this.userError.mobile_number=e.error.errors.mobile_number),e.error.errors.password&&(this.userError.password=e.error.errors.password),e.error.errors.roles&&(this.userError.roles=e.error.errors.role),e.error.errors.balance&&(this.userError.balance=e.error.errors.balance))})}back(){this.coreService.location.back()}formatRole(t){switch(t){default:return t}}onMobileVerifiedChange(t){this.userRequest.mobile_verified=t}onImageChanged(t){let l=t.target.files[0];this.userRequest.image=l}static{this.\u0275fac=function(l){return new(l||n)(v(x),v(O),v(q))}}static{this.\u0275cmp=I({type:n,selectors:[["save"]],decls:95,vars:82,consts:[["form","ngForm"],["name","ngModel"],["email","ngModel"],["mobile_number","ngModel"],["password","ngModel"],["roles","ngModel"],["language","ngModel"],["balance","ngModel"],[1,"row"],[1,"col-md-12"],["nbSpinnerStatus","danger",3,"nbSpinner"],[3,"ngSubmit"],[1,"form-group"],["type","text","nbInput","","fullWidth","","placeholder","Name","name","name","required","",3,"ngModelChange","ngModel"],[1,"error","text-danger",3,"hidden"],["class","error text-danger",4,"ngFor","ngForOf"],["type","email","nbInput","","fullWidth","","placeholder","Email","name","email","required","",3,"ngModelChange","ngModel"],["type","mobile_number","nbInput","","fullWidth","","placeholder","Mobile Number","name","mobile_number","required","",3,"ngModelChange","ngModel"],["name","mobile_verified","nbInput","","fullWidth","",1,"form-control",3,"checkedChange","checked"],["type","password","nbInput","","fullWidth","","id","password","placeholder","Password","name","password",3,"ngModelChange","ngModel","required"],["fullWidth","","name","roles","multiple","",2,"text-transform","capitalize",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","file","nbInput","","fullWidth","",3,"change"],["type","language","nbInput","","fullWidth","","placeholder","Language","name","language","required","",3,"ngModelChange","ngModel"],["type","number","nbInput","","fullWidth","","placeholder","Balance","name","balance","required","",3,"ngModelChange","ngModel"],["type","submit","nbButton","","status","success","size","medium","nbSpinnerStatus","success","nbSpinnerSize","small",3,"disabled","nbSpinner"],["type","button","nbButton","","status","danger","size","medium",3,"click"],[1,"error","text-danger"],[3,"value"]],template:function(l,e){if(l&1){let g=Q();a(0,"div",8)(1,"div",9)(2,"nb-card")(3,"nb-card-body",10)(4,"form",11,0),w("ngSubmit",function(){return f(g),b(e.saveUser())}),a(6,"div",12)(7,"label"),s(8),m(9,"translate"),r(),a(10,"input",13,1),y("ngModelChange",function(o){return f(g),R(e.userRequest.name,o)||(e.userRequest.name=o),b(o)}),r(),a(12,"label",14),s(13),m(14,"translate"),r(),S(15,we,2,1,"label",15),r(),a(16,"div",12)(17,"label"),s(18),m(19,"translate"),r(),a(20,"input",16,2),y("ngModelChange",function(o){return f(g),R(e.userRequest.email,o)||(e.userRequest.email=o),b(o)}),r(),a(22,"label",14),s(23),m(24,"translate"),r(),S(25,Ie,2,1,"label",15),r(),a(26,"div",12)(27,"label"),s(28),m(29,"translate"),r(),a(30,"input",17,3),y("ngModelChange",function(o){return f(g),R(e.userRequest.mobile_number,o)||(e.userRequest.mobile_number=o),b(o)}),r(),a(32,"label",14),s(33),m(34,"translate"),r(),S(35,Me,2,1,"label",15),r(),a(36,"div",12)(37,"label"),s(38),m(39,"translate"),r(),a(40,"nb-checkbox",18),w("checkedChange",function(o){return f(g),b(e.onMobileVerifiedChange(o))}),s(41),m(42,"translate"),r(),S(43,Be,2,1,"label",15),r(),a(44,"div",12)(45,"label"),s(46),m(47,"translate"),r(),a(48,"input",19,4),y("ngModelChange",function(o){return f(g),R(e.userRequest.password,o)||(e.userRequest.password=o),b(o)}),r(),a(50,"label",14),s(51),m(52,"translate"),r(),S(53,Le,2,1,"label",15),r(),a(54,"div",12)(55,"label"),s(56),m(57,"translate"),r(),a(58,"nb-select",20,5),y("ngModelChange",function(o){return f(g),R(e.userRequest.roles,o)||(e.userRequest.roles=o),b(o)}),S(60,qe,2,2,"nb-option",21),r(),S(61,Ae,2,1,"label",15),r(),a(62,"div",12)(63,"label"),s(64),m(65,"translate"),r(),a(66,"input",22),w("change",function(o){return f(g),b(e.onImageChanged(o))}),r(),S(67,Ne,2,1,"label",15),r(),a(68,"div",12)(69,"label"),s(70),m(71,"translate"),r(),a(72,"input",23,6),y("ngModelChange",function(o){return f(g),R(e.userRequest.language,o)||(e.userRequest.language=o),b(o)}),r(),a(74,"label",14),s(75),m(76,"translate"),r(),S(77,Te,2,1,"label",15),r(),a(78,"div",12)(79,"label"),s(80),m(81,"translate"),r(),a(82,"input",24,7),y("ngModelChange",function(o){return f(g),R(e.userRequest.balance,o)||(e.userRequest.balance=o),b(o)}),r(),a(84,"label",14),s(85),m(86,"translate"),r(),S(87,xe,2,1,"label",15),r(),a(88,"button",25),s(89),m(90,"translate"),r(),s(91," \xA0 "),a(92,"button",26),w("click",function(){return f(g),b(e.back())}),s(93),m(94,"translate"),r()()()()()()}if(l&2){let g=E(5),h=E(11),o=E(21),G=E(31),z=E(49),H=E(73),K=E(83);i(3),p("nbSpinner",e.showProgress),i(5),u(d(9,46,"USER.NAME.LABEL")),i(2),C("ngModel",e.userRequest.name),i(2),p("hidden",h.valid||h.pristine),i(),_(" ",d(14,48,"USER.NAME.VALIDATION")," "),i(2),p("ngForOf",e.userError.name),i(3),u(d(19,50,"USER.EMAIL.LABEL")),i(2),C("ngModel",e.userRequest.email),i(2),p("hidden",o.valid||o.pristine),i(),_(" ",d(24,52,"USER.EMAIL.VALIDATION")," "),i(2),p("ngForOf",e.userError.email),i(3),u(d(29,54,"USER.MOBILE_NUMBER.LABEL")),i(2),C("ngModel",e.userRequest.mobile_number),i(2),p("hidden",G.valid||G.pristine),i(),_(" ",d(34,56,"USER.MOBILE_NUMBER.VALIDATION")," "),i(2),p("ngForOf",e.userError.mobile_number),i(3),u(d(39,58,"USER.MOBILE_VERIFIED.LABEL")),i(2),p("checked",e.userRequest.mobile_verified),i(),_("",d(42,60,"USER.MOBILE_VERIFIED.LABEL"),"?"),i(2),p("ngForOf",e.userError.mobile_verified),i(3),u(d(47,62,"USER.PASSWORD.LABEL")),i(2),C("ngModel",e.userRequest.password),p("required",!e.isEdit),i(2),p("hidden",z.valid||z.pristine),i(),_(" ",d(52,64,"USER.PASSWORD.VALIDATION")," "),i(2),p("ngForOf",e.userError.password),i(3),u(d(57,66,"USER.ROLES.LABEL")),i(2),C("ngModel",e.userRequest.roles),i(2),p("ngForOf",e.userRoles),i(),p("ngForOf",e.userError.roles),i(3),u(d(65,68,"USER.IMAGE.LABEL")),i(3),p("ngForOf",e.userError.image),i(3),u(d(71,70,"USER.LANGUAGE.LABEL")),i(2),C("ngModel",e.userRequest.language),i(2),p("hidden",H.valid||H.pristine),i(),_(" ",d(76,72,"USER.LANGUAGE.VALIDATION")," "),i(2),p("ngForOf",e.userError.language),i(3),u(d(81,74,"USER.BALANCE.LABEL")),i(2),C("ngModel",e.userRequest.balance),i(2),p("hidden",K.valid||K.pristine),i(),_(" ",d(86,76,"USER.BALANCE.VALIDATION")," "),i(2),p("ngForOf",e.userError.balance),i(),p("disabled",!g.form.valid||e.showProgressButton)("nbSpinner",e.showProgressButton),i(),_(" ",d(90,78,"COMMON.SAVE")," "),i(4),_(" ",d(94,80,"COMMON.BACK")," ")}},dependencies:[Y,ae,ee,oe,te,ie,se,re,ne,pe,ce,ue,T,N,A,me,de,V],encapsulation:2})}}return n})();var Ve=[{path:"",component:_e,children:[{path:"add",component:j},{path:"list",component:Se},{path:"edit/:id",component:j}]}],ve=(()=>{class n{static{this.\u0275fac=function(l){return new(l||n)}}static{this.\u0275mod=L({type:n})}static{this.\u0275inj=B({imports:[k.forChild(Ve),k]})}}return n})();var ot=(()=>{class n{static{this.\u0275fac=function(l){return new(l||n)}}static{this.\u0275mod=L({type:n})}static{this.\u0275inj=B({imports:[he,ve]})}}return n})();export{ot as UsersModule};
